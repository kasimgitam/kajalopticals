<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAJAL OPTICALS - Premium Eyewear Studio</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #b38b6d;
            --accent: #e8c07d;
            --light: #f9f5f0;
            --dark: #1a1a1a;
            --success: #27ae60;
            --warning: #e74c3c;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .luxury-header {
            text-align: center;
            padding: 30px 0 20px;
            border-bottom: 1px solid rgba(179, 139, 109, 0.3);
            margin-bottom: 40px;
            position: relative;
        }
        
        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .logo-inner {
            width: 70px;
            height: 70px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: 28px;
            color: var(--primary);
            position: relative;
        }
        
        .logo-inner::before {
            content: "";
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid var(--secondary);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .logo-inner::after {
            content: "";
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 3px solid var(--accent);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .luxury-header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.8rem;
            color: var(--primary);
            letter-spacing: 1px;
            margin-bottom: 10px;
        }
        
        .luxury-header .subtitle {
            font-size: 1.1rem;
            color: var(--secondary);
            letter-spacing: 3px;
            text-transform: uppercase;
            font-weight: 300;
        }
        
        .luxury-header::after {
            content: "";
            display: block;
            width: 100px;
            height: 2px;
            background: var(--accent);
            margin: 20px auto 0;
        }
        
        .luxury-card {
            background: white;
            border-radius: 4px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 30px;
            margin-bottom: 40px;
            border-top: 4px solid var(--secondary);
        }
        
        .section-title {
            font-family: 'Playfair Display', serif;
            color: var(--primary);
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(179, 139, 109, 0.2);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary);
            font-size: 0.9rem;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.95rem;
            transition: all 0.3s;
            background-color: #fafafa;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 2px rgba(179, 139, 109, 0.2);
            background-color: white;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 3px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #1a2a38;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #9a7557;
            transform: translateY(-2px);
        }
        
        .btn-accent {
            background-color: var(--accent);
            color: var(--dark);
        }
        
        .btn-accent:hover {
            background-color: #e0b469;
            transform: translateY(-2px);
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid var(--secondary);
            color: var(--secondary);
        }
        
        .btn-outline:hover {
            background-color: rgba(179, 139, 109, 0.1);
        }
        
        .btn-danger {
            background-color: var(--warning);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .error {
            color: var(--warning);
            font-size: 0.8rem;
            margin-top: 5px;
            display: block;
        }
        
        /* Luxury table styles */
        .luxury-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            font-size: 0.95rem;
        }
        
        .luxury-table th {
            background-color: var(--primary);
            color: white;
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .luxury-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .luxury-table tr:nth-child(even) {
            background-color: #fafafa;
        }
        
        .luxury-table tr:hover {
            background-color: rgba(179, 139, 109, 0.05);
        }
        
        .action-btns {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            padding: 5px 10px;
            font-size: 0.8rem;
            border-radius: 3px;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .view-btn {
            background-color: var(--primary);
            color: white;
        }
        
        .edit-btn {
            background-color: var(--accent);
            color: var(--dark);
        }
        
        .delete-btn {
            background-color: var(--warning);
            color: white;
        }
        
        /* Print styles */
        @media print {
            body * {
                visibility: hidden;
            }
            .print-section, .print-section *,
            .print-sales-section, .print-sales-section * {
                visibility: visible;
            }
            .print-section, .print-sales-section {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 20px;
                margin: 0;
            }
            .no-print {
                display: none !important;
            }
        }
        
        .print-section {
            display: none;
            padding: 40px;
            font-family: 'Playfair Display', serif;
        }
        
        .print-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--secondary);
        }
        
        .print-header h2 {
            font-size: 28px;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .print-header p {
            color: var(--secondary);
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
        }
        
        .print-details {
            margin: 30px 0;
        }
        
        .print-row {
            display: flex;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .print-label {
            min-width: 180px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .print-divider {
            height: 1px;
            background: rgba(179, 139, 109, 0.3);
            margin: 20px 0;
        }
        
        .print-signature {
            margin-top: 60px;
            text-align: right;
        }
        
        .print-signature-line {
            display: inline-block;
            width: 200px;
            border-top: 1px solid var(--dark);
            padding-top: 5px;
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
        }
        
        /* Sales Report Styles */
        .sales-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .sales-date-filter {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .sales-summary {
            background: white;
            padding: 20px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .summary-card {
            text-align: center;
            padding: 15px 25px;
            min-width: 200px;
            border-radius: 4px;
            background: var(--light);
        }
        
        .summary-card h3 {
            color: var(--secondary);
            font-size: 1rem;
            margin-bottom: 10px;
        }
        
        .summary-card p {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        /* Print Sales Report Styles */
        .print-sales-section {
            display: none;
            padding: 40px;
            font-family: 'Playfair Display', serif;
        }
        
        .print-sales-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--secondary);
        }
        
        .print-sales-header h2 {
            font-size: 28px;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .print-sales-header p {
            color: var(--secondary);
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
        }
        
        .print-sales-date {
            text-align: center;
            margin-bottom: 20px;
            font-size: 18px;
            color: var(--primary);
        }
        
        .print-sales-summary {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .print-summary-card {
            text-align: center;
            padding: 15px;
            min-width: 200px;
        }
        
        .print-summary-card h3 {
            color: var(--secondary);
            font-size: 1rem;
            margin-bottom: 10px;
        }
        
        .print-summary-card p {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        .print-sales-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .print-sales-table th {
            background-color: var(--primary);
            color: white;
            padding: 10px;
            text-align: left;
        }
        
        .print-sales-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .luxury-header h1 {
                font-size: 2rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .sales-controls {
                flex-direction: column;
            }
        }
        
        /* Tab navigation */
        .tab-nav {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(179, 139, 109, 0.3);
        }
        
        .tab-btn {
            padding: 12px 25px;
            background: none;
            border: none;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            color: var(--secondary);
            position: relative;
        }
        
        .tab-btn.active {
            color: var(--primary);
        }
        
        .tab-btn.active::after {
            content: "";
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--secondary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="luxury-header">
            <div class="logo-container">
                <div class="logo">
                    <div class="logo-inner">KO</div>
                </div>
            </div>
            <h1>KAJAL OPTICALS</h1>
            <div class="subtitle">PREMIUM EYEWEAR STUDIO</div>
        </div>
        
        <div class="tab-nav no-print">
            <button class="tab-btn active" onclick="openTab('customerTab')">Customer Management</button>
            <button class="tab-btn" onclick="openTab('salesTab')">Daily Sales Report</button>
        </div>
        
        <!-- Customer Management Tab -->
        <div id="customerTab" class="tab-content active">
            <div class="luxury-card no-print">
                <h2 class="section-title">Customer Registration</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="customerId">Customer ID</label>
                        <input type="text" id="customerId" readonly>
                    </div>
                    <div class="form-group">
                        <label for="registrationDate">Registration Date</label>
                        <input type="date" id="registrationDate">
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="fullName">Full Name*</label>
                        <input type="text" id="fullName" placeholder="Enter full name">
                        <span id="nameError" class="error"></span>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone Number*</label>
                        <input type="tel" id="phone" placeholder="Enter phone number">
                        <span id="phoneError" class="error"></span>
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" placeholder="Enter email address">
                        <span id="emailError" class="error"></span>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="age">Age</label>
                        <input type="number" id="age" placeholder="Enter age" min="1" max="120">
                    </div>
                    <div class="form-group">
                        <label for="gender">Gender</label>
                        <select id="gender">
                            <option value="">Select gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="address">Full Address</label>
                    <textarea id="address" rows="3" placeholder="Enter full address"></textarea>
                </div>
                
                <h2 class="section-title" style="margin-top: 30px;">Eye Prescription Details</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="leftEyePower">Left Eye Power (SPH)</label>
                        <input type="text" id="leftEyePower" placeholder="e.g., -2.50">
                    </div>
                    <div class="form-group">
                        <label for="rightEyePower">Right Eye Power (SPH)</label>
                        <input type="text" id="rightEyePower" placeholder="e.g., -3.00">
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="leftCylinder">Left Eye (CYL)</label>
                        <input type="text" id="leftCylinder" placeholder="e.g., -0.50">
                    </div>
                    <div class="form-group">
                        <label for="rightCylinder">Right Eye (CYL)</label>
                        <input type="text" id="rightCylinder" placeholder="e.g., -0.75">
                    </div>
                    <div class="form-group">
                        <label for="pupillaryDistance">Pupillary Distance (PD)</label>
                        <input type="text" id="pupillaryDistance" placeholder="e.g., 62">
                    </div>
                </div>
                
                <h2 class="section-title" style="margin-top: 30px;">Frame & Lens Selection</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="frameBrand">Frame Brand</label>
                        <select id="frameBrand">
                            <option value="">Select frame brand</option>
                            <option value="Ray-Ban">Ray-Ban</option>
                            <option value="Oakley">Oakley</option>
                            <option value="Gucci">Gucci</option>
                            <option value="Prada">Prada</option>
                            <option value="Versace">Versace</option>
                            <option value="Tom Ford">Tom Ford</option>
                            <option value="Dior">Dior</option>
                            <option value="KAJAL Premium">KAJAL Premium</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="frameModel">Frame Model</label>
                        <input type="text" id="frameModel" placeholder="Enter frame model">
                    </div>
                    <div class="form-group">
                        <label for="frameCost">Frame Cost (₹)</label>
                        <input type="number" id="frameCost" placeholder="Enter frame cost" min="0" step="100">
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="lensBrand">Lens Brand</label>
                        <select id="lensBrand">
                            <option value="">Select lens brand</option>
                            <option value="Essilor">Essilor</option>
                            <option value="Zeiss">Zeiss</option>
                            <option value="Hoya">Hoya</option>
                            <option value="Nikon">Nikon</option>
                            <option value="KAJAL Blue Cut">KAJAL Blue Cut</option>
                            <option value="KAJAL Premium">KAJAL Premium</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="lensType">Lens Type</label>
                        <select id="lensType">
                            <option value="">Select lens type</option>
                            <option value="Single Vision">Single Vision</option>
                            <option value="Bifocal">Bifocal</option>
                            <option value="Progressive">Progressive</option>
                            <option value="Photochromic">Photochromic</option>
                            <option value="Blue Cut">Blue Cut</option>
                            <option value="Polarized">Polarized</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="lensCost">Lens Cost (₹)</label>
                        <input type="number" id="lensCost" placeholder="Enter lens cost" min="0" step="100">
                    </div>
                </div>
                
                <h2 class="section-title" style="margin-top: 30px;">Payment Details</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="totalAmount">Total Amount (₹)</label>
                        <input type="number" id="totalAmount" placeholder="Enter total amount" min="0" step="100">
                    </div>
                    <div class="form-group">
                        <label for="advanceAmount">Advance Paid (₹)</label>
                        <input type="number" id="advanceAmount" placeholder="Enter advance amount" min="0" step="100">
                    </div>
                    <div class="form-group">
                        <label for="balanceDue">Balance Due (₹)</label>
                        <input type="number" id="balanceDue" placeholder="Balance due" readonly>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="deliveryDate">Delivery Date</label>
                        <input type="date" id="deliveryDate">
                    </div>
                    <div class="form-group">
                        <label for="paymentMethod">Payment Method</label>
                        <select id="paymentMethod">
                            <option value="">Select payment method</option>
                            <option value="Cash">Cash</option>
                            <option value="Credit Card">Credit Card</option>
                            <option value="Debit Card">Debit Card</option>
                            <option value="UPI">UPI</option>
                            <option value="Bank Transfer">Bank Transfer</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="notes">Special Notes</label>
                    <textarea id="notes" rows="2" placeholder="Any special notes or instructions"></textarea>
                </div>
                
                <div class="button-group">
                    <button id="saveBtn" class="btn btn-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
                        </svg>
                        Save Customer
                    </button>
                    <button id="newBtn" class="btn btn-outline">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                            <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                        </svg>
                        New Customer
                    </button>
                    <button id="printBtn" class="btn btn-accent">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M5 1a2 2 0 0 0-2 2v1h10V3a2 2 0 0 0-2-2H5zm6 8H5a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1z"/>
                            <path d="M0 7a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2h-1v-2a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2H2a2 2 0 0 1-2-2V7zm2.5 1a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"/>
                        </svg>
                        Print Receipt
                    </button>
                    <button id="clearBtn" class="btn btn-danger">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                            <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                        </svg>
                        Clear Form
                    </button>
                </div>
            </div>
            
            <div class="no-print">
                <h2 class="section-title">Customer Records</h2>
                <table class="luxury-table">
                    <thead>
                        <tr>
                            <th>Customer ID</th>
                            <th>Name</th>
                            <th>Phone</th>
                            <th>Frame Brand</th>
                            <th>Lens Brand</th>
                            <th>Total (₹)</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="customerTableBody">
                        <!-- Customer records will be displayed here -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Daily Sales Report Tab -->
        <div id="salesTab" class="tab-content">
            <div class="luxury-card no-print">
                <h2 class="section-title">Daily Sales Report</h2>
                
                <div class="sales-controls">
                    <div class="sales-date-filter">
                        <label for="salesDate">Select Date:</label>
                        <input type="date" id="salesDate">
                        <button id="viewSalesBtn" class="btn btn-primary">View Sales</button>
                        <button id="printSalesBtn" class="btn btn-accent">Print Report</button>
                    </div>
                    <button id="viewAllSalesBtn" class="btn btn-outline">View All Sales</button>
                </div>
                
                <div class="sales-summary">
                    <div class="summary-card">
                        <h3>Total Customers</h3>
                        <p id="totalCustomers">0</p>
                    </div>
                    <div class="summary-card">
                        <h3>Total Sales</h3>
                        <p id="totalSales">₹0</p>
                    </div>
                    <div class="summary-card">
                        <h3>Total Advance</h3>
                        <p id="totalAdvance">₹0</p>
                    </div>
                    <div class="summary-card">
                        <h3>Balance Due</h3>
                        <p id="totalBalance">₹0</p>
                    </div>
                </div>
                
                <table class="luxury-table">
                    <thead>
                        <tr>
                            <th>Customer ID</th>
                            <th>Name</th>
                            <th>Frame Brand</th>
                            <th>Lens Brand</th>
                            <th>Total (₹)</th>
                            <th>Advance (₹)</th>
                            <th>Balance (₹)</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="salesTableBody">
                        <!-- Sales records will be displayed here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Print Section (hidden until printing) -->
    <div class="print-section" id="printSection">
        <div class="print-header">
            <h2>KAJAL OPTICALS</h2>
            <p>Premium Eyewear Studio | Since 2010</p>
            <p>8-2-26/2, Main Road, Beside Visakha Eye Hospital, Panthulugarimeeda, Gajuwaka</p>
            <p>Phone: 9395361093</p>
        </div>
        
        <div class="print-details">
            <div class="print-row">
                <div class="print-label">Invoice Number:</div>
                <div id="printCustomerId">KAJAL/2024/001</div>
            </div>
            <div class="print-row">
                <div class="print-label">Date:</div>
                <div id="printDate">June 6, 2024</div>
            </div>
            <div class="print-row">
                <div class="print-label">Customer Name:</div>
                <div id="printName">Rahul Sharma</div>
            </div>
            <div class="print-row">
                <div class="print-label">Phone Number:</div>
                <div id="printPhone">+91 9876543210</div>
            </div>
            
            <div class="print-divider"></div>
            
            <h3>Prescription Details</h3>
            <div class="print-row">
                <div class="print-label">Left Eye (SPH/CYL):</div>
                <div id="printLeftEye">-2.50 / -0.50</div>
            </div>
            <div class="print-row">
                <div class="print-label">Right Eye (SPH/CYL):</div>
                <div id="printRightEye">-3.00 / -0.75</div>
            </div>
            <div class="print-row">
                <div class="print-label">Pupillary Distance:</div>
                <div id="printPupillaryDistance">62 mm</div>
            </div>
            
            <div class="print-divider"></div>
            
            <h3>Order Details</h3>
            <div class="print-row">
                <div class="print-label">Frame Brand:</div>
                <div id="printFrameBrand">Ray-Ban RB2140</div>
            </div>
            <div class="print-row">
                <div class="print-label">Frame Cost:</div>
                <div id="printFrameCost">₹8,500</div>
            </div>
            <div class="print-row">
                <div class="print-label">Lens Brand:</div>
                <div id="printLensBrand">Essilor Crizal</div>
            </div>
            <div class="print-row">
                <div class="print-label">Lens Type:</div>
                <div id="printLensType">Blue Cut</div>
            </div>
            <div class="print-row">
                <div class="print-label">Lens Cost:</div>
                <div id="printLensCost">₹6,200</div>
            </div>
            
            <div class="print-divider"></div>
            
            <h3>Payment Details</h3>
            <div class="print-row">
                <div class="print-label">Total Amount:</div>
                <div id="printTotalAmount">₹14,700</div>
            </div>
            <div class="print-row">
                <div class="print-label">Advance Paid:</div>
                <div id="printAdvanceAmount">₹5,000</div>
            </div>
            <div class="print-row">
                <div class="print-label">Balance Due:</div>
                <div id="printBalanceDue">₹9,700</div>
            </div>
            <div class="print-row">
                <div class="print-label">Payment Method:</div>
                <div id="printPaymentMethod">Credit Card</div>
            </div>
            <div class="print-row">
                <div class="print-label">Delivery Date:</div>
                <div id="printDeliveryDate">June 10, 2024</div>
            </div>
            
            <div class="print-signature">
                <div class="print-signature-line">Authorized Signature</div>
            </div>
            
            <div style="margin-top: 30px; text-align: center; font-size: 12px; color: #666;">
                Thank you for choosing KAJAL OPTICALS. For any queries, please contact 9395361093
            </div>
        </div>
    </div>
    
    <!-- Print Sales Report Section -->
    <div class="print-sales-section" id="printSalesSection">
        <div class="print-sales-header">
            <h2>KAJAL OPTICALS</h2>
            <p>Premium Eyewear Studio | Since 2010</p>
            <p>8-2-26/2, Main Road, Beside Visakha Eye Hospital, Panthulugarimeeda, Gajuwaka</p>
            <p>Phone: 9395361093</p>
        </div>
        
        <div class="print-sales-date" id="printSalesDate">
            Sales Report for June 6, 2024
        </div>
        
        <div class="print-sales-summary">
            <div class="print-summary-card">
                <h3>Total Customers</h3>
                <p id="printTotalCustomers">0</p>
            </div>
            <div class="print-summary-card">
                <h3>Total Sales</h3>
                <p id="printTotalSales">₹0</p>
            </div>
            <div class="print-summary-card">
                <h3>Total Advance</h3>
                <p id="printTotalAdvance">₹0</p>
            </div>
            <div class="print-summary-card">
                <h3>Balance Due</h3>
                <p id="printTotalBalanceDue">₹0</p>
            </div>
        </div>
        
        <table class="print-sales-table">
            <thead>
                <tr>
                    <th>Customer ID</th>
                    <th>Name</th>
                    <th>Frame Brand</th>
                    <th>Lens Brand</th>
                    <th>Total (₹)</th>
                    <th>Advance (₹)</th>
                    <th>Balance (₹)</th>
                </tr>
            </thead>
            <tbody id="printSalesTableBody">
                <!-- Sales records will be displayed here -->
            </tbody>
        </table>
        
        <div class="print-signature">
            <div class="print-signature-line">Authorized Signature</div>
        </div>
        
        <div style="margin-top: 30px; text-align: center; font-size: 12px; color: #666;">
            Thank you for choosing KAJAL OPTICALS. For any queries, please contact 9395361093
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get DOM elements
            const customerIdInput = document.getElementById('customerId');
            const registrationDateInput = document.getElementById('registrationDate');
            const fullNameInput = document.getElementById('fullName');
            const phoneInput = document.getElementById('phone');
            const emailInput = document.getElementById('email');
            const ageInput = document.getElementById('age');
            const genderInput = document.getElementById('gender');
            const addressInput = document.getElementById('address');
            const leftEyePowerInput = document.getElementById('leftEyePower');
            const rightEyePowerInput = document.getElementById('rightEyePower');
            const leftCylinderInput = document.getElementById('leftCylinder');
            const rightCylinderInput = document.getElementById('rightCylinder');
            const pupillaryDistanceInput = document.getElementById('pupillaryDistance');
            const frameBrandInput = document.getElementById('frameBrand');
            const frameModelInput = document.getElementById('frameModel');
            const frameCostInput = document.getElementById('frameCost');
            const lensBrandInput = document.getElementById('lensBrand');
            const lensTypeInput = document.getElementById('lensType');
            const lensCostInput = document.getElementById('lensCost');
            const totalAmountInput = document.getElementById('totalAmount');
            const advanceAmountInput = document.getElementById('advanceAmount');
            const balanceDueInput = document.getElementById('balanceDue');
            const deliveryDateInput = document.getElementById('deliveryDate');
            const paymentMethodInput = document.getElementById('paymentMethod');
            const notesInput = document.getElementById('notes');
            
            // Sales report elements
            const salesDateInput = document.getElementById('salesDate');
            const viewSalesBtn = document.getElementById('viewSalesBtn');
            const printSalesBtn = document.getElementById('printSalesBtn');
            const viewAllSalesBtn = document.getElementById('viewAllSalesBtn');
            const totalCustomersEl = document.getElementById('totalCustomers');
            const totalSalesEl = document.getElementById('totalSales');
            const totalAdvanceEl = document.getElementById('totalAdvance');
            const totalBalanceEl = document.getElementById('totalBalance');
            const salesTableBody = document.getElementById('salesTableBody');
            
            // Print sales report elements
            const printSalesSection = document.getElementById('printSalesSection');
            const printSalesDateEl = document.getElementById('printSalesDate');
            const printTotalCustomersEl = document.getElementById('printTotalCustomers');
            const printTotalSalesEl = document.getElementById('printTotalSales');
            const printTotalAdvanceEl = document.getElementById('printTotalAdvance');
            const printTotalBalanceDueEl = document.getElementById('printTotalBalanceDue');
            const printSalesTableBody = document.getElementById('printSalesTableBody');
            
            // Buttons
            const saveBtn = document.getElementById('saveBtn');
            const newBtn = document.getElementById('newBtn');
            const printBtn = document.getElementById('printBtn');
            const clearBtn = document.getElementById('clearBtn');
            
            // Table
            const customerTableBody = document.getElementById('customerTableBody');
            
            // Print section elements
            const printSection = document.getElementById('printSection');
            const printCustomerId = document.getElementById('printCustomerId');
            const printDate = document.getElementById('printDate');
            const printName = document.getElementById('printName');
            const printPhone = document.getElementById('printPhone');
            const printLeftEye = document.getElementById('printLeftEye');
            const printRightEye = document.getElementById('printRightEye');
            const printPupillaryDistance = document.getElementById('printPupillaryDistance');
            const printFrameBrand = document.getElementById('printFrameBrand');
            const printFrameCost = document.getElementById('printFrameCost');
            const printLensBrand = document.getElementById('printLensBrand');
            const printLensType = document.getElementById('printLensType');
            const printLensCost = document.getElementById('printLensCost');
            const printTotalAmount = document.getElementById('printTotalAmount');
            const printAdvanceAmount = document.getElementById('printAdvanceAmount');
            const printBalanceDue = document.getElementById('printBalanceDue');
            const printPaymentMethod = document.getElementById('printPaymentMethod');
            const printDeliveryDate = document.getElementById('printDeliveryDate');
            
            // Error elements
            const nameError = document.getElementById('nameError');
            const phoneError = document.getElementById('phoneError');
            const emailError = document.getElementById('emailError');
            
            // Store customers in local storage
            let customers = JSON.parse(localStorage.getItem('kajalOpticalsCustomers')) || {};
            
            // Initialize form
            function initForm() {
                const today = new Date();
                registrationDateInput.valueAsDate = today;
                salesDateInput.valueAsDate = today; // Set sales date to today by default
                generateCustomerId(today);
                
                // Set default delivery date to 7 days from today
                const deliveryDate = new Date();
                deliveryDate.setDate(deliveryDate.getDate() + 7);
                deliveryDateInput.valueAsDate = deliveryDate;
            }
            
            // Generate customer ID in format YYYYMMDDNN
            function generateCustomerId(date) {
                const dateStr = date.toISOString().split('T')[0].replace(/-/g, '');
                const idPrefix = dateStr; // YYYYMMDD
                
                // Count how many customers we have for this date
                let count = 0;
                for (const id in customers) {
                    if (id.startsWith(idPrefix)) {
                        count++;
                    }
                }
                
                count++; // Increment for new customer
                const countStr = count.toString().padStart(2, '0');
                customerIdInput.value = idPrefix + countStr;
            }
            
            // Calculate balance due
            function calculateBalance() {
                const total = parseFloat(totalAmountInput.value) || 0;
                const advance = parseFloat(advanceAmountInput.value) || 0;
                const balance = total - advance;
                balanceDueInput.value = balance > 0 ? balance.toFixed(2) : '0.00';
            }
            
            // Calculate total amount when frame or lens costs change
            function calculateTotalAmount() {
                const frameCost = parseFloat(frameCostInput.value) || 0;
                const lensCost = parseFloat(lensCostInput.value) || 0;
                const total = frameCost + lensCost;
                totalAmountInput.value = total.toFixed(2);
                calculateBalance();
            }
            
            // Save customer
            saveBtn.addEventListener('click', function() {
                if (validateForm()) {
                    const customerId = customerIdInput.value;
                    
                    customers[customerId] = {
                        registrationDate: registrationDateInput.value,
                        fullName: fullNameInput.value.trim(),
                        phone: phoneInput.value.trim(),
                        email: emailInput.value.trim(),
                        age: ageInput.value.trim(),
                        gender: genderInput.value,
                        address: addressInput.value.trim(),
                        leftEyePower: leftEyePowerInput.value.trim(),
                        rightEyePower: rightEyePowerInput.value.trim(),
                        leftCylinder: leftCylinderInput.value.trim(),
                        rightCylinder: rightCylinderInput.value.trim(),
                        pupillaryDistance: pupillaryDistanceInput.value.trim(),
                        frameBrand: frameBrandInput.value,
                        frameModel: frameModelInput.value.trim(),
                        frameCost: frameCostInput.value.trim(),
                        lensBrand: lensBrandInput.value,
                        lensType: lensTypeInput.value,
                        lensCost: lensCostInput.value.trim(),
                        totalAmount: totalAmountInput.value.trim(),
                        advanceAmount: advanceAmountInput.value.trim(),
                        balanceDue: balanceDueInput.value.trim(),
                        deliveryDate: deliveryDateInput.value,
                        paymentMethod: paymentMethodInput.value,
                        notes: notesInput.value.trim()
                    };
                    
                    localStorage.setItem('kajalOpticalsCustomers', JSON.stringify(customers));
                    alert('Customer saved successfully!');
                    updateCustomerTable();
                    clearForm();
                    initForm();
                }
            });
            
            // New customer
            newBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to start a new customer? Any unsaved changes will be lost.')) {
                    clearForm();
                    initForm();
                }
            });
            
            // Print receipt
            printBtn.addEventListener('click', function() {
                const customerId = customerIdInput.value;
                
                if (!customerId || !customers[customerId]) {
                    alert('Please save the customer first before printing');
                    return;
                }
                
                const customer = customers[customerId];
                
                // Format dates
                const regDate = new Date(customer.registrationDate);
                const formattedDate = regDate.toLocaleDateString('en-IN', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                });
                
                let formattedDeliveryDate = 'Not specified';
                if (customer.deliveryDate) {
                    const delDate = new Date(customer.deliveryDate);
                    formattedDeliveryDate = delDate.toLocaleDateString('en-IN', {
                        day: '2-digit',
                        month: 'short',
                        year: 'numeric'
                    });
                }
                
                // Format eye prescription
                const leftEye = customer.leftEyePower ? 
                    customer.leftEyePower + (customer.leftCylinder ? ' / ' + customer.leftCylinder : '') : 
                    'Not specified';
                
                const rightEye = customer.rightEyePower ? 
                    customer.rightEyePower + (customer.rightCylinder ? ' / ' + customer.rightCylinder : '') : 
                    'Not specified';
                
                // Format currency
                const formatCurrency = (value) => {
                    if (!value) return '₹0';
                    const num = parseFloat(value);
                    return '₹' + num.toLocaleString('en-IN');
                };
                
                // Update print section
                printCustomerId.textContent = 'KAJAL/' + customerId.substring(0, 4) + '/' + customerId.substring(8);
                printDate.textContent = formattedDate;
                printName.textContent = customer.fullName;
                printPhone.textContent = customer.phone;
                printLeftEye.textContent = leftEye;
                printRightEye.textContent = rightEye;
                printPupillaryDistance.textContent = customer.pupillaryDistance ? customer.pupillaryDistance + ' mm' : 'Not specified';
                
                printFrameBrand.textContent = customer.frameBrand ? 
                    customer.frameBrand + (customer.frameModel ? ' ' + customer.frameModel : '') : 
                    'Not specified';
                printFrameCost.textContent = formatCurrency(customer.frameCost);
                
                printLensBrand.textContent = customer.lensBrand || 'Not specified';
                printLensType.textContent = customer.lensType || 'Not specified';
                printLensCost.textContent = formatCurrency(customer.lensCost);
                
                printTotalAmount.textContent = formatCurrency(customer.totalAmount);
                printAdvanceAmount.textContent = formatCurrency(customer.advanceAmount);
                printBalanceDue.textContent = formatCurrency(customer.balanceDue);
                printPaymentMethod.textContent = customer.paymentMethod || 'Not specified';
                printDeliveryDate.textContent = formattedDeliveryDate;
                
                // Show print section and print
                printSection.style.display = 'block';
                window.print();
                printSection.style.display = 'none';
            });
            
            // Clear form
            clearBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to clear the form? All entered data will be lost.')) {
                    clearForm();
                    initForm();
                }
            });
            
            function clearForm() {
                customerIdInput.value = '';
                fullNameInput.value = '';
                phoneInput.value = '';
                emailInput.value = '';
                ageInput.value = '';
                genderInput.value = '';
                addressInput.value = '';
                leftEyePowerInput.value = '';
                rightEyePowerInput.value = '';
                leftCylinderInput.value = '';
                rightCylinderInput.value = '';
                pupillaryDistanceInput.value = '';
                frameBrandInput.value = '';
                frameModelInput.value = '';
                frameCostInput.value = '';
                lensBrandInput.value = '';
                lensTypeInput.value = '';
                lensCostInput.value = '';
                totalAmountInput.value = '';
                advanceAmountInput.value = '';
                balanceDueInput.value = '';
                deliveryDateInput.value = '';
                paymentMethodInput.value = '';
                notesInput.value = '';
                
                // Clear errors
                nameError.textContent = '';
                phoneError.textContent = '';
                emailError.textContent = '';
            }
            
            // Update customer table
            function updateCustomerTable() {
                customerTableBody.innerHTML = '';
                
                // Convert customers object to array and sort by customer ID (newest first)
                const customerArray = Object.entries(customers)
                    .map(([id, data]) => ({ id, ...data }))
                    .sort((a, b) => b.id.localeCompare(a.id));
                
                for (const customer of customerArray) {
                    const row = document.createElement('tr');
                    
                    // Format currency
                    const formatCurrency = (value) => {
                        if (!value) return '-';
                        const num = parseFloat(value);
                        return '₹' + num.toLocaleString('en-IN');
                    };
                    
                    row.innerHTML = `
                        <td>${customer.id}</td>
                        <td>${customer.fullName}</td>
                        <td>${customer.phone}</td>
                        <td>${customer.frameBrand || '-'}</td>
                        <td>${customer.lensBrand || '-'}</td>
                        <td>${formatCurrency(customer.totalAmount)}</td>
                        <td class="action-btns">
                            <button class="action-btn view-btn" onclick="viewCustomer('${customer.id}')">View</button>
                            <button class="action-btn edit-btn" onclick="editCustomer('${customer.id}')">Edit</button>
                            <button class="action-btn delete-btn" onclick="deleteCustomer('${customer.id}')">Delete</button>
                        </td>
                    `;
                    
                    customerTableBody.appendChild(row);
                }
            }
            
            // View sales for selected date
            viewSalesBtn.addEventListener('click', function() {
                const selectedDate = salesDateInput.value;
                if (!selectedDate) {
                    alert('Please select a date');
                    return;
                }
                
                generateSalesReport(selectedDate);
            });
            
            // View all sales
            viewAllSalesBtn.addEventListener('click', function() {
                generateSalesReport();
            });
            
            // Print sales report
            printSalesBtn.addEventListener('click', function() {
                const selectedDate = salesDateInput.value;
                if (!selectedDate) {
                    alert('Please select a date to print the sales report');
                    return;
                }
                
                preparePrintSalesReport(selectedDate);
            });
            
            // Generate sales report for specific date or all dates
            function generateSalesReport(date = null) {
                salesTableBody.innerHTML = '';
                
                let totalCustomers = 0;
                let totalSales = 0;
                let totalAdvance = 0;
                let totalBalance = 0;
                
                // Convert customers object to array
                const customerArray = Object.entries(customers)
                    .map(([id, data]) => ({ id, ...data }));
                
                // Filter by date if specified
                const filteredCustomers = date ? 
                    customerArray.filter(customer => customer.registrationDate === date) :
                    customerArray;
                
                // Sort by date (newest first)
                filteredCustomers.sort((a, b) => {
                    const dateA = new Date(a.registrationDate);
                    const dateB = new Date(b.registrationDate);
                    return dateB - dateA;
                });
                
                // Format currency
                const formatCurrency = (value) => {
                    if (!value) return '₹0';
                    const num = parseFloat(value);
                    return '₹' + num.toLocaleString('en-IN');
                };
                
                for (const customer of filteredCustomers) {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td>${customer.id}</td>
                        <td>${customer.fullName}</td>
                        <td>${customer.frameBrand || '-'}</td>
                        <td>${customer.lensBrand || '-'}</td>
                        <td>${formatCurrency(customer.totalAmount)}</td>
                        <td>${formatCurrency(customer.advanceAmount)}</td>
                        <td>${formatCurrency(customer.balanceDue)}</td>
                        <td class="action-btns">
                            <button class="action-btn view-btn" onclick="viewCustomer('${customer.id}')">View</button>
                        </td>
                    `;
                    
                    salesTableBody.appendChild(row);
                    
                    // Update totals
                    totalCustomers++;
                    totalSales += parseFloat(customer.totalAmount) || 0;
                    totalAdvance += parseFloat(customer.advanceAmount) || 0;
                    totalBalance += parseFloat(customer.balanceDue) || 0;
                }
                
                // Update summary cards
                totalCustomersEl.textContent = totalCustomers;
                totalSalesEl.textContent = formatCurrency(totalSales);
                totalAdvanceEl.textContent = formatCurrency(totalAdvance);
                totalBalanceEl.textContent = formatCurrency(totalBalance);
            }
            
            // Prepare sales report for printing
            function preparePrintSalesReport(date = null) {
                printSalesTableBody.innerHTML = '';
                
                let totalCustomers = 0;
                let totalSales = 0;
                let totalAdvance = 0;
                let totalBalance = 0;
                
                // Convert customers object to array
                const customerArray = Object.entries(customers)
                    .map(([id, data]) => ({ id, ...data }));
                
                // Filter by date if specified
                const filteredCustomers = date ? 
                    customerArray.filter(customer => customer.registrationDate === date) :
                    customerArray;
                
                // Format currency
                const formatCurrency = (value) => {
                    if (!value) return '₹0';
                    const num = parseFloat(value);
                    return '₹' + num.toLocaleString('en-IN');
                };
                
                for (const customer of filteredCustomers) {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td>${customer.id}</td>
                        <td>${customer.fullName}</td>
                        <td>${customer.frameBrand || '-'}</td>
                        <td>${customer.lensBrand || '-'}</td>
                        <td>${formatCurrency(customer.totalAmount)}</td>
                        <td>${formatCurrency(customer.advanceAmount)}</td>
                        <td>${formatCurrency(customer.balanceDue)}</td>
                    `;
                    
                    printSalesTableBody.appendChild(row);
                    
                    // Update totals
                    totalCustomers++;
                    totalSales += parseFloat(customer.totalAmount) || 0;
                    totalAdvance += parseFloat(customer.advanceAmount) || 0;
                    totalBalance += parseFloat(customer.balanceDue) || 0;
                }
                
                // Update summary cards
                printTotalCustomersEl.textContent = totalCustomers;
                printTotalSalesEl.textContent = formatCurrency(totalSales);
                printTotalAdvanceEl.textContent = formatCurrency(totalAdvance);
                printTotalBalanceDueEl.textContent = formatCurrency(totalBalance);
                
                // Set the date for the report
                if (date) {
                    const reportDate = new Date(date);
                    const formattedDate = reportDate.toLocaleDateString('en-IN', {
                        day: '2-digit',
                        month: 'short',
                        year: 'numeric'
                    });
                    printSalesDateEl.textContent = `Sales Report for ${formattedDate}`;
                } else {
                    printSalesDateEl.textContent = 'Complete Sales Report (All Dates)';
                }
                
                // Show print section and print
                printSalesSection.style.display = 'block';
                window.print();
                printSalesSection.style.display = 'none';
            }
            
            // Tab navigation
            window.openTab = function(tabId) {
                // Hide all tab contents
                const tabContents = document.getElementsByClassName('tab-content');
                for (let i = 0; i < tabContents.length; i++) {
                    tabContents[i].classList.remove('active');
                }
                
                // Deactivate all tab buttons
                const tabButtons = document.getElementsByClassName('tab-btn');
                for (let i = 0; i < tabButtons.length; i++) {
                    tabButtons[i].classList.remove('active');
                }
                
                // Activate the selected tab
                document.getElementById(tabId).classList.add('active');
                event.currentTarget.classList.add('active');
                
                // If opening sales tab, generate today's report by default
                if (tabId === 'salesTab') {
                    const today = new Date().toISOString().split('T')[0];
                    salesDateInput.value = today;
                    generateSalesReport(today);
                }
            };
            
            // View customer (for table buttons)
            window.viewCustomer = function(customerId) {
                const customer = customers[customerId];
                
                // Format dates
                const regDate = new Date(customer.registrationDate);
                const formattedRegDate = regDate.toLocaleDateString('en-IN', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                });
                
                let formattedDeliveryDate = 'Not specified';
                if (customer.deliveryDate) {
                    const delDate = new Date(customer.deliveryDate);
                    formattedDeliveryDate = delDate.toLocaleDateString('en-IN', {
                        day: '2-digit',
                        month: 'short',
                        year: 'numeric'
                    });
                }
                
                // Format currency
                const formatCurrency = (value) => {
                    if (!value) return '₹0';
                    const num = parseFloat(value);
                    return '₹' + num.toLocaleString('en-IN');
                };
                
                // Format eye prescription
                const leftEye = customer.leftEyePower ? 
                    customer.leftEyePower + (customer.leftCylinder ? ' / ' + customer.leftCylinder : '') : 
                    'Not specified';
                
                const rightEye = customer.rightEyePower ? 
                    customer.rightEyePower + (customer.rightCylinder ? ' / ' + customer.rightCylinder : '') : 
                    'Not specified';
                
                alert(`KAJAL OPTICALS - CUSTOMER DETAILS\n
Customer ID: ${customerId}
Registration Date: ${formattedRegDate}

CUSTOMER INFORMATION:
Name: ${customer.fullName}
Phone: ${customer.phone}
Email: ${customer.email || 'N/A'}
Age: ${customer.age || 'N/A'}
Gender: ${customer.gender || 'N/A'}
Address: ${customer.address || 'N/A'}

PRESCRIPTION DETAILS:
Left Eye: ${leftEye}
Right Eye: ${rightEye}
Pupillary Distance: ${customer.pupillaryDistance || 'N/A'} mm

ORDER DETAILS:
Frame: ${customer.frameBrand || 'N/A'} ${customer.frameModel || ''}
Frame Cost: ${formatCurrency(customer.frameCost)}
Lens: ${customer.lensBrand || 'N/A'} (${customer.lensType || 'N/A'})
Lens Cost: ${formatCurrency(customer.lensCost)}

PAYMENT DETAILS:
Total Amount: ${formatCurrency(customer.totalAmount)}
Advance Paid: ${formatCurrency(customer.advanceAmount)}
Balance Due: ${formatCurrency(customer.balanceDue)}
Payment Method: ${customer.paymentMethod || 'N/A'}
Delivery Date: ${formattedDeliveryDate}

Notes: ${customer.notes || 'N/A'}`);
            };
            
            // Edit customer (for table buttons)
            window.editCustomer = function(customerId) {
                const customer = customers[customerId];
                
                if (confirm('Load this customer for editing? Current form data will be lost.')) {
                    customerIdInput.value = customerId;
                    registrationDateInput.value = customer.registrationDate;
                    fullNameInput.value = customer.fullName;
                    phoneInput.value = customer.phone;
                    emailInput.value = customer.email || '';
                    ageInput.value = customer.age || '';
                    genderInput.value = customer.gender || '';
                    addressInput.value = customer.address || '';
                    leftEyePowerInput.value = customer.leftEyePower || '';
                    rightEyePowerInput.value = customer.rightEyePower || '';
                    leftCylinderInput.value = customer.leftCylinder || '';
                    rightCylinderInput.value = customer.rightCylinder || '';
                    pupillaryDistanceInput.value = customer.pupillaryDistance || '';
                    frameBrandInput.value = customer.frameBrand || '';
                    frameModelInput.value = customer.frameModel || '';
                    frameCostInput.value = customer.frameCost || '';
                    lensBrandInput.value = customer.lensBrand || '';
                    lensTypeInput.value = customer.lensType || '';
                    lensCostInput.value = customer.lensCost || '';
                    totalAmountInput.value = customer.totalAmount || '';
                    advanceAmountInput.value = customer.advanceAmount || '';
                    balanceDueInput.value = customer.balanceDue || '';
                    deliveryDateInput.value = customer.deliveryDate || '';
                    paymentMethodInput.value = customer.paymentMethod || '';
                    notesInput.value = customer.notes || '';
                    
                    // Scroll to top
                    window.scrollTo(0, 0);
                }
            };
            
            // Delete customer (for table buttons)
            window.deleteCustomer = function(customerId) {
                if (confirm('Are you sure you want to delete this customer? This cannot be undone.')) {
                    delete customers[customerId];
                    localStorage.setItem('kajalOpticalsCustomers', JSON.stringify(customers));
                    updateCustomerTable();
                    
                    // If on sales tab, refresh the sales report
                    if (document.getElementById('salesTab').classList.contains('active')) {
                        const selectedDate = salesDateInput.value;
                        if (selectedDate) {
                            generateSalesReport(selectedDate);
                        } else {
                            generateSalesReport();
                        }
                    }
                    
                    alert('Customer deleted successfully');
                }
            };
            
            // Form validation
            function validateForm() {
                let isValid = true;
                
                // Clear previous errors
                nameError.textContent = '';
                phoneError.textContent = '';
                emailError.textContent = '';
                
                // Validate Full Name
                if (!fullNameInput.value.trim()) {
                    nameError.textContent = 'Full name is required';
                    isValid = false;
                }
                
                // Validate Phone
                const phone = phoneInput.value.trim();
                if (!phone) {
                    phoneError.textContent = 'Phone number is required';
                    isValid = false;
                } else if (!isValidPhone(phone)) {
                    phoneError.textContent = 'Please enter a valid phone number';
                    isValid = false;
                }
                
                // Validate Email if provided
                const email = emailInput.value.trim();
                if (email && !isValidEmail(email)) {
                    emailError.textContent = 'Please enter a valid email';
                    isValid = false;
                }
                
                return isValid;
            }
            
            // Email validation helper
            function isValidEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            }
            
            // Phone validation helper (simple version)
            function isValidPhone(phone) {
                const re = /^[\d\s\-+()]{8,}$/;
                return re.test(phone);
            }
            
            // Event listeners for auto-calculation
            frameCostInput.addEventListener('change', calculateTotalAmount);
            lensCostInput.addEventListener('change', calculateTotalAmount);
            totalAmountInput.addEventListener('change', calculateBalance);
            advanceAmountInput.addEventListener('change', calculateBalance);
            
            // Update customer ID when date changes
            registrationDateInput.addEventListener('change', function() {
                generateCustomerId(new Date(this.value));
            });
            
            // Initialize the form and table when page loads
            initForm();
            updateCustomerTable();
        });
    </script>
</body>
</html>
